{{ define "MapTest" }}
<div id="details">

</div>

                 <iframe id="currentloc" src="" width="700" height="300" frameborder="0" style="border:0"></iframe>
<script>
	// map.innerHTML = '<iframe width="700" height="300" src="https://maps.google.com/maps?q='+latitude+','+longitude+'&amp;z=15&amp;output=embed"></iframe>';
var reqcount = 0;

navigator.geolocation.watchPosition(successCallback, errorCallback, options);

function successCallback(position) {
	const { accuracy, latitude, longitude, altitude, heading, speed } = position.coords;
    // Show a map centered at latitude / longitude.
    reqcount++;
    details.innerHTML = "Accuracy: "+accuracy+"<br>";
    details.innerHTML += "Latitude: "+latitude+" | Longitude: "+longitude+"<br>";
    details.innerHTML += "Altitude: "+altitude+"<br>";
    details.innerHTML += "Heading: "+heading+"<br>";
    details.innerHTML += "Speed: "+speed+"<br>";
    details.innerHTML += "reqcount: "+reqcount;
	
	    var src = "https://maps.google.com/maps?q="+latitude+", "+longitude+"&z=15&output=embed";
    document.getElementById('currentloc').src = src;
}
function errorCallback(error) {
	
}
var options = {
	//enableHighAccuracy: false,
	//timeout: 1000,
	//maximumAge: 0
};

navigator.permissions.query({ name: 'geolocation' })
.then(console.log)
</script>
{{ end }}